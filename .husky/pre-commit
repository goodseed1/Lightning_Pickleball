# Lightning Tennis Project Quality Gate
echo "ğŸ›ï¸ Running Lightning Tennis Quality Gate..."

# 1. Run lint-staged (ESLint, Prettier, ls-lint)
echo "ğŸ“ Checking code style and structure..."
npx lint-staged

# 2. Check for circular dependencies (excluding navigation patterns)
echo "ğŸ”„ Checking for circular dependencies..."
madge --circular --extensions ts,tsx --exclude "navigation/*" src/ || {
  echo "âš ï¸  Warning: Circular dependencies detected outside navigation."
  echo "Navigation-screen dependencies are expected, but other circulars should be investigated."
}

# 3. Check for unused dependencies (quick check)  
echo "ğŸ“¦ Checking for unused dependencies..."
npx depcheck --ignores="@types/*,@storybook/*,eslint-*,prettier,husky,lint-staged,@size-limit/*,madge" --skip-missing || {
  echo "âš ï¸  Warning: Unused dependencies detected. Run 'npm run dep-check' for details."
}

echo "âœ… Quality gate passed! Proceeding with commit..."