# 🧪 LPR 마이그레이션 테스트 플랜

**작성일**: 2024-12-30
**목적**: NTRP → LPR 마이그레이션 후 기능 검증
**예상 소요 시간**: 30-45분

---

## 📋 테스트 환경 준비

### 사전 조건

- [ ] Expo 앱 실행 중 (`npx expo start`)
- [ ] Cloud Functions 배포 완료 ✅
- [ ] 테스트 계정 준비 (기존 사용자 + 신규 사용자)

### 테스트 계정

| 계정 유형                  | 용도                 |
| -------------------------- | -------------------- |
| 신규 계정                  | 온보딩 플로우 테스트 |
| 기존 계정 (ntrpLevel 있음) | 하위 호환성 테스트   |
| 기존 계정 (ltrLevel 있음)  | 정상 동작 테스트     |

---

## 🧪 Test Suite 1: 온보딩 플로우 (신규 사용자)

### 1.1 LPR 레벨 선택 화면

| #     | 테스트 케이스           | 예상 결과                                              | Pass/Fail |
| ----- | ----------------------- | ------------------------------------------------------ | --------- |
| 1.1.1 | LPR 레벨 선택 화면 표시 | 1-10 레벨이 티어별로 표시 (Bronze, Silver, Gold, etc.) | ⬜        |
| 1.1.2 | 레벨 선택 시 상세 설명  | 해당 레벨의 스킬, 전술, 경험 설명 표시                 | ⬜        |
| 1.1.3 | "NTRP" 텍스트 없음      | UI에 "NTRP" 문자열이 없고 "LPR"만 표시                 | ⬜        |

### 1.2 자가 진단 (LPR Assessment)

| #     | 테스트 케이스  | 예상 결과                                                    | Pass/Fail |
| ----- | -------------- | ------------------------------------------------------------ | --------- |
| 1.2.1 | 진단 시작 버튼 | "LPR 자가 진단" 또는 "LPR Assessment" 표시                   | ⬜        |
| 1.2.2 | 질문 화면      | 4가지 카테고리 질문 표시 (Skills, Tactics, Experience, Self) | ⬜        |
| 1.2.3 | 결과 화면      | LPR 1-10 정수 결과 표시 (소수점 없음)                        | ⬜        |
| 1.2.4 | 추천 레벨      | "추천 LPR: 6" 형식으로 표시                                  | ⬜        |

### 1.3 프로필 저장

| #     | 테스트 케이스  | 예상 결과                               | Pass/Fail |
| ----- | -------------- | --------------------------------------- | --------- |
| 1.3.1 | Firestore 저장 | `users/{uid}.ltrLevel` 필드에 정수 저장 | ⬜        |
| 1.3.2 | ntrpLevel 없음 | `ntrpLevel` 필드가 생성되지 않음        | ⬜        |

---

## 🧪 Test Suite 2: 매치 생성

### 2.1 단식 매치 생성

| #     | 테스트 케이스     | 예상 결과                                   | Pass/Fail |
| ----- | ----------------- | ------------------------------------------- | --------- |
| 2.1.1 | LPR 범위 슬라이더 | 1-10 범위 선택 가능                         | ⬜        |
| 2.1.2 | LPR 범위 표시     | "LPR 5-7" 형식 (소수점 없음)                | ⬜        |
| 2.1.3 | Firestore 저장    | `minLtr`, `maxLtr` 필드에 정수 저장         | ⬜        |
| 2.1.4 | 레거시 필드       | `minNtrp`, `maxNtrp`도 하위호환성 위해 저장 | ⬜        |

### 2.2 복식 매치 생성

| #     | 테스트 케이스  | 예상 결과                                | Pass/Fail |
| ----- | -------------- | ---------------------------------------- | --------- |
| 2.2.1 | 파트너 선택    | 파트너 LPR 표시                          | ⬜        |
| 2.2.2 | 파트너 갭 검증 | ±2 LPR 이내 파트너만 선택 가능           | ⬜        |
| 2.2.3 | 팀 평균 LPR    | 호스트 + 파트너 평균 계산 정확           | ⬜        |
| 2.2.4 | 에러 메시지    | 갭 초과 시 "LPR 갭이 너무 큽니다" 메시지 | ⬜        |

---

## 🧪 Test Suite 3: 프로필 화면

### 3.1 내 프로필

| #     | 테스트 케이스 | 예상 결과                    | Pass/Fail |
| ----- | ------------- | ---------------------------- | --------- |
| 3.1.1 | LPR 표시      | "LPR 7" 형식 (정수)          | ⬜        |
| 3.1.2 | 티어 표시     | "Platinum" 등 티어 이름 표시 | ⬜        |
| 3.1.3 | ELO 기반 계산 | ELO에서 변환된 LPR 표시      | ⬜        |

### 3.2 타 유저 프로필

| #     | 테스트 케이스 | 예상 결과               | Pass/Fail |
| ----- | ------------- | ----------------------- | --------- |
| 3.2.1 | LPR 표시      | "LPR 5" 형식            | ⬜        |
| 3.2.2 | "NTRP" 없음   | UI에 "NTRP" 문자열 없음 | ⬜        |

---

## 🧪 Test Suite 4: Discovery 화면

### 4.1 매치 카드

| #     | 테스트 케이스   | 예상 결과        | Pass/Fail |
| ----- | --------------- | ---------------- | --------- |
| 4.1.1 | LPR 범위 표시   | "LPR 4-6" 형식   | ⬜        |
| 4.1.2 | 호스트 LPR 표시 | 호스트 레벨 표시 | ⬜        |

### 4.2 필터링

| #     | 테스트 케이스 | 예상 결과                  | Pass/Fail |
| ----- | ------------- | -------------------------- | --------- |
| 4.2.1 | LPR 필터      | LPR 범위로 필터링 가능     | ⬜        |
| 4.2.2 | 필터 결과     | 내 LPR ±1 범위 매치만 표시 | ⬜        |

---

## 🧪 Test Suite 5: 하위 호환성 (기존 데이터)

### 5.1 기존 사용자 (ntrpLevel 필드)

| #     | 테스트 케이스 | 예상 결과                    | Pass/Fail |
| ----- | ------------- | ---------------------------- | --------- |
| 5.1.1 | 프로필 로딩   | ntrpLevel → LPR 변환 표시    | ⬜        |
| 5.1.2 | 매치 참가     | 기존 사용자도 정상 참가 가능 | ⬜        |

### 5.2 기존 매치 (minNtrp 필드)

| #     | 테스트 케이스  | 예상 결과                          | Pass/Fail |
| ----- | -------------- | ---------------------------------- | --------- |
| 5.2.1 | 매치 카드 표시 | minNtrp → minLtr 폴백 후 정상 표시 | ⬜        |
| 5.2.2 | 매치 참가 신청 | 기존 매치에도 정상 신청 가능       | ⬜        |

---

## 🧪 Test Suite 6: Cloud Functions

### 6.1 매치 생성 함수

| #     | 테스트 케이스        | 예상 결과               | Pass/Fail |
| ----- | -------------------- | ----------------------- | --------- |
| 6.1.1 | createMatchAndInvite | LPR 검증 후 매치 생성   | ⬜        |
| 6.1.2 | validateMatchLtr     | LPR 범위 검증 정상 작동 | ⬜        |

### 6.2 LPR 관련 함수

| #     | 테스트 케이스     | 예상 결과            | Pass/Fail |
| ----- | ----------------- | -------------------- | --------- |
| 6.2.1 | getUserLtrLevel   | 사용자 LPR 레벨 반환 | ⬜        |
| 6.2.2 | migrateLtrFromElo | ELO → LPR 변환 정상  | ⬜        |

---

## 🧪 Test Suite 7: 번역 (i18n)

### 7.1 한국어

| #     | 테스트 케이스 | 예상 결과           | Pass/Fail |
| ----- | ------------- | ------------------- | --------- |
| 7.1.1 | LPR 레벨      | "LPR 레벨" 표시     | ⬜        |
| 7.1.2 | 불일치 메시지 | "LPR 불일치" 메시지 | ⬜        |

### 7.2 영어

| #     | 테스트 케이스    | 예상 결과             | Pass/Fail |
| ----- | ---------------- | --------------------- | --------- |
| 7.2.1 | LPR Level        | "LPR Level" 표시      | ⬜        |
| 7.2.2 | Mismatch message | "LPR mismatch" 메시지 | ⬜        |

---

## 🧪 Test Suite 8: AI 챗봇

| #   | 테스트 케이스    | 예상 결과                       | Pass/Fail |
| --- | ---------------- | ------------------------------- | --------- |
| 8.1 | LPR 질문         | "LPR이 뭐예요?" → LPR 설명 응답 | ⬜        |
| 8.2 | 파트너 규칙 질문 | "파트너 갭 규칙" → ±2 LPR 설명  | ⬜        |
| 8.3 | NTRP 질문        | "NTRP vs LPR" → 차이점 설명     | ⬜        |

---

## 📊 테스트 결과 요약

| Test Suite         | 총 케이스 | Pass | Fail |
| ------------------ | --------- | ---- | ---- |
| 1. 온보딩          | 7         | ⬜   | ⬜   |
| 2. 매치 생성       | 8         | ⬜   | ⬜   |
| 3. 프로필          | 5         | ⬜   | ⬜   |
| 4. Discovery       | 4         | ⬜   | ⬜   |
| 5. 하위 호환성     | 4         | ⬜   | ⬜   |
| 6. Cloud Functions | 4         | ⬜   | ⬜   |
| 7. 번역            | 4         | ⬜   | ⬜   |
| 8. AI 챗봇         | 3         | ⬜   | ⬜   |
| **총합**           | **39**    | ⬜   | ⬜   |

---

## 🔧 테스트 실패 시 조치

### 일반적인 문제

1. **"NTRP" 텍스트 발견**: 해당 화면의 번역 키 확인
2. **소수점 표시**: `.toFixed()` 제거 필요
3. **Firestore 필드 오류**: 하위 호환성 폴백 확인

### 롤백 절차

```bash
# 코드 롤백
git checkout HEAD~1

# Functions 롤백
cd functions && npm run build && firebase deploy --only functions
```

---

## ✅ 테스트 완료 체크리스트

- [ ] 모든 Test Suite 완료
- [ ] 실패 케이스 0개 확인
- [ ] 스크린샷/녹화 저장 (선택)
- [ ] 테스트 결과 문서 업데이트

---

**테스터**: ******\_\_\_\_******
**테스트 일시**: ******\_\_\_\_******
**결과**: Pass / Fail
**비고**: ******\_\_\_\_******
